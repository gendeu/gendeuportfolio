<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gen Deu Gagarin | UI/UX Portfolio</title>
  <meta name="description" content="Gen Deu Gagarin — UI/UX Developer & Frontend Engineer" />
  <style>
:root{--bg1:#0f2027;--bg2:#203a43;--bg3:#2c5364;--text:#f5f5f5;--accent:#00f2fe;--glass-bg:rgba(255,255,255,0.08);--glass-border:rgba(255,255,255,0.2)}
body.light{--bg1:#dbe6f6;--bg2:#cfd9df;--bg3:#e2ebf0;--text:#222;--accent:#3f51b5;--glass-bg:rgba(255,255,255,0.5);--glass-border:rgba(0,0,0,0.1)}
*{box-sizing:border-box}html,body{height:100%;margin:0;font-family:'Poppins',system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial;color:var(--text);-webkit-font-smoothing:antialiased}
body{background:linear-gradient(-45deg,var(--bg1),var(--bg2),var(--bg3));background-size:400% 400%;animation:gradientMove 25s ease infinite;transition:background .8s ease,color .3s ease}
@keyframes gradientMove{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
#bgCanvas{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-2}
#progress-bar{position:fixed;top:0;left:0;height:3px;background:var(--accent);width:0;z-index:2000;transition:width .4s ease}
header{position:sticky;top:0;z-index:1000;backdrop-filter:blur(12px);padding:1rem 2rem}nav{display:flex;justify-content:space-between;align-items:center;gap:1rem}nav ul{list-style:none;display:flex;gap:1.5rem;margin:0;padding:0}nav ul li a{text-decoration:none;color:var(--text);position:relative}nav ul li a::after{content:"";position:absolute;left:0;bottom:-4px;width:100%;height:2px;background:var(--accent);transform:scaleX(0);transition:transform .3s ease;transform-origin:left}nav ul li a:hover::after{transform:scaleX(1)}#menu-toggle{display:none;cursor:pointer;font-size:1.5rem}
.page{display:none;opacity:0;transform:translateY(20px);transition:opacity .45s ease,transform .45s ease;min-height:80vh;padding:4rem 2rem}.page.active{display:block;opacity:1;transform:translateY(0)}
.hero{text-align:center;margin-top:15vh;padding:2rem}.highlight{color:var(--accent)}
.card.glass{padding:2rem;border-radius:20px;background:var(--glass-bg);border:1px solid var(--glass-border);backdrop-filter:blur(15px);margin:1.5rem auto;width:90%;max-width:1000px;text-align:center;transition:transform .25s ease,box-shadow .25s ease}.card.glass:hover{transform:translateY(-5px) scale(1.02);box-shadow:0 10px 20px rgba(0,0,0,.3)}
.btn{display:inline-block;margin-top:2rem;padding:.8rem 1.5rem;border-radius:30px;background:var(--glass-bg);border:1px solid var(--glass-border);backdrop-filter:blur(10px);color:var(--accent);font-weight:bold;text-decoration:none;transition:transform .2s ease,background .2s ease}.btn:hover{transform:scale(1.06);background:var(--accent);color:#111}
.project-grid{display:grid;gap:1.5rem;grid-template-columns:repeat(3,1fr)}@media (max-width:1024px){.project-grid{grid-template-columns:repeat(2,1fr)}}@media (max-width:720px){.project-grid{grid-template-columns:1fr}}
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);justify-content:center;align-items:center;z-index:6000;opacity:0;transition:opacity .3s ease}.modal.show{opacity:1;display:flex}.modal-content{max-width:720px;padding:2rem;border-radius:20px;background:var(--glass-bg);border:1px solid var(--glass-border);backdrop-filter:blur(15px);transform:scale(.96);opacity:0;transition:transform .25s ease,opacity .25s ease;position:relative}.modal.show .modal-content{transform:scale(1);opacity:1}.close{position:absolute;top:15px;right:20px;font-size:1.6rem;cursor:pointer}
.skills-list{display:flex;flex-wrap:wrap;justify-content:center;gap:1rem}.chip{padding:.8rem 1.2rem;border-radius:30px;background:var(--glass-bg);border:1px solid var(--glass-border);backdrop-filter:blur(8px)}
footer{text-align:center;padding:2rem;color:rgba(255,255,255,.7)}
@media (max-width:768px){nav ul{display:none;flex-direction:column;gap:1rem;background:rgba(0,0,0,.85);padding:1rem;position:absolute;top:60px;right:20px;border-radius:12px}nav ul.show{display:flex;animation:slideIn .4s ease}@keyframes slideIn{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}#menu-toggle{display:block}.hero h2{font-size:1.8rem}.project-grid{grid-template-columns:1fr}}
.muted{color:rgba(255,255,255,.65);font-size:.95rem}

/* Projects header + view toggle */
.projects-header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px}
.view-toggle{display:flex;gap:8px}
.view-btn{width:40px;height:40px;border-radius:8px;border:1px solid rgba(255,255,255,.06);background:transparent;color:var(--text);cursor:pointer;font-size:18px;display:flex;align-items:center;justify-content:center}
.view-btn[aria-pressed="true"]{background:var(--accent);color:#071225;box-shadow:0 8px 18px rgba(0,0,0,.35);border-color:rgba(255,255,255,.08)}

/* ---------- CAROUSEL STYLES (CENTER-STAGE, NO VISIBLE SCROLLBAR) ---------- */
.carousel-view{display:flex;position:relative;align-items:center;gap:12px;margin:0 0 1.75rem 0}
.carousel-view.hidden{display:none} /* <-- IMPORTANT: allow JS to hide carousel */
.carousel-viewport{overflow:hidden;width:100%}
.carousel-track{
  display:flex;
  gap:18px;
  padding:22px 12px;
  overflow-x:auto;
  scroll-snap-type:x mandatory;
  scroll-behavior:smooth;
  -webkit-overflow-scrolling:touch;
  align-items:center;
  padding-left: calc(50% - 150px);
  padding-right: calc(50% - 150px);
}
.carousel-track::-webkit-scrollbar{height:0;display:none}
.carousel-track{ -ms-overflow-style: none; scrollbar-width: none; }

.carousel-item{
  min-width:300px;
  flex:0 0 300px;
  scroll-snap-align:center;
  display:flex;
  flex-direction:column;
  gap:10px;
  padding:12px;
  border-radius:14px;
  background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border:1px solid rgba(255,255,255,0.03);
  cursor:pointer;
  transform-origin:center center;
  transition: transform 180ms cubic-bezier(.18,.85,.32,1), box-shadow 180ms cubic-bezier(.18,.85,.32,1), z-index 180ms;
  will-change: transform, box-shadow;
  transform: translateY(0) scale(0.96);
  z-index: 1;
  opacity: 0.98;
}
.carousel-thumb{height:160px;border-radius:10px;background-size:cover;background-position:center;box-shadow:0 8px 30px rgba(0,0,0,.35)}

/* Active (center) item: larger & lifted */
.carousel-item.active{
  transform: translateY(-18px) scale(1.1);
  z-index: 30;
  box-shadow: 0 40px 100px rgba(2,6,23,0.72), 0 14px 44px rgba(0,0,0,0.44);
  opacity: 1;
}

/* neighbor styling */
.carousel-item.sibling{
  transform: translateY(-10px) scale(0.99);
  z-index: 10;
  box-shadow: 0 16px 36px rgba(0,0,0,0.32);
}

/* bigger arrows */
.carousel-nav{
  position:relative;
  z-index:40;
  border:none;
  background:rgba(0,0,0,0.55);
  color:var(--text);
  padding:16px 18px;
  border-radius:14px;
  cursor:pointer;
  min-width:72px;
  font-size:30px;
  display:flex;
  align-items:center;
  justify-content:center;
  transition:transform .12s ease,background .15s ease;
}
.carousel-nav:hover{transform:scale(1.04);background:rgba(0,0,0,0.65)}
.carousel-prev{margin-right:12px}
.carousel-next{margin-left:12px}

/* Grid view */
.grid-view{display:block}
.grid-view.hidden{display:none}
.project-grid .project{padding:18px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.02);cursor:pointer;transition:transform .2s ease}
.project-grid .project:hover{transform:translateY(-6px)}

/* responsive tweaks */
@media (max-width:900px){
  .carousel-item{min-width:220px;flex:0 0 220px}
  .carousel-thumb{height:120px}
  .carousel-track{padding-left: calc(50% - 110px); padding-right: calc(50% - 110px);}
  .carousel-nav{min-width:48px;padding:10px 12px;font-size:22px}
}
@media (max-width:520px){
  header{padding:0.7rem 1rem}
  .hero{margin-top:8vh}
}

/* Loader styles (floating GD circle) */
#loader{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);z-index:7000;pointer-events:none;opacity:0;transition:opacity .28s ease}
.loader-logo{width:84px;height:84px;border-radius:50%;background:var(--glass-bg);border:2px solid var(--glass-border);display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--accent);font-size:1.15rem;backdrop-filter:blur(8px);box-shadow:0 8px 30px rgba(0,0,0,0.35);transition:transform .28s ease,box-shadow .28s ease}
.loader-logo span{user-select:none}
#dim{position:fixed;inset:0;background:rgba(0,0,0,0.28);z-index:6900;opacity:0;pointer-events:none;transition:opacity .28s ease}
.loader-visible{opacity:1}
  </style>
</head>
<body>
  <!-- Loader (floating) -->
  <div id="loader" aria-hidden="true"><div class="loader-logo"><span>GD</span></div></div>
  <div id="dim" aria-hidden="true"></div>

  <!-- Particle Background -->
  <canvas id="bgCanvas"></canvas>

  <!-- Progress bar -->
  <div id="progress-bar" aria-hidden="true"></div>

  <!-- Navbar -->
  <header>
    <nav>
      <h1 class="logo">GenDeu</h1>
      <div id="menu-toggle">☰</div>
      <ul>
        <li><a href="#home" class="nav-link active">Home</a></li>
        <li><a href="#about" class="nav-link">About</a></li>
        <li><a href="#projects" class="nav-link">Projects</a></li>
        <li><a href="#skills" class="nav-link">Skills</a></li>
        <li><a href="#contact" class="nav-link">Contact</a></li>
      </ul>
      <button id="theme-toggle">🌙</button>
    </nav>
  </header>

  <!-- Hero -->
  <section id="home" class="page active">
    <div class="hero">
      <h2>Hello, I’m <span class="highlight">Gen Deu</span></h2>
      <p class="tagline"><span id="typewriter"></span></p>
      <a href="#projects" class="btn nav-link">See My Work</a>
    </div>
  </section>

  <!-- About -->
  <section id="about" class="page">
    <h2>About Me</h2>
    <div class="card glass fade-in">
      <p>I’m a UI/UX Developer and Frontend Engineer passionate about creating sleek, user-focused web experiences. I bridge design and code, ensuring beautiful interfaces deliver smooth, intuitive interactions.</p>
    </div>
  </section>

  <!-- Projects -->
  <section id="projects" class="page">
    <div class="projects-header">
      <h2>Case Studies</h2>

      <!-- View toggle -->
      <div class="view-toggle" role="tablist" aria-label="Projects view toggle">
        <button id="btn-carousel" class="view-btn" aria-pressed="true" title="Carousel view">🎮</button>
        <button id="btn-grid" class="view-btn" aria-pressed="false" title="Grid view">▦</button>
      </div>
    </div>

    <!-- CAROUSEL VIEW -->
    <div id="carouselView" class="carousel-view active" aria-hidden="false">
      <button class="carousel-nav carousel-prev" aria-label="Previous">‹</button>

      <div class="carousel-viewport">
        <div class="carousel-track" tabindex="0" role="listbox" aria-label="Project carousel">
          <!-- carousel items -->
          <div class="card glass carousel-item" data-key="klp" role="option" aria-label="KLP Lifestyle">
            <div class="carousel-thumb" style="background-image:url('assets/klp.jpg')"></div>
            <h3>KLP Lifestyle</h3>
            <p class="muted">E-commerce redesign</p>
          </div>

          <div class="card glass carousel-item" data-key="fixifoot" role="option" aria-label="Fixifoot">
            <div class="carousel-thumb" style="background-image:url('assets/fixifoot.jpg')"></div>
            <h3>Fixifoot</h3>
            <p class="muted">Product showcase</p>
          </div>

          <div class="card glass carousel-item" data-key="cveez" role="option" aria-label="Cveez">
            <div class="carousel-thumb" style="background-image:url('assets/cveez.jpg')"></div>
            <h3>Cveez</h3>
            <p class="muted">Service booking platform</p>
          </div>

          <div class="card glass carousel-item" data-key="other1" role="option" aria-label="Other Project 1">
            <div class="carousel-thumb" style="background-image:url('assets/other1.jpg')"></div>
            <h3>Other 1</h3>
            <p class="muted">UI components</p>
          </div>

          <div class="card glass carousel-item" data-key="other2" role="option" aria-label="Other Project 2">
            <div class="carousel-thumb" style="background-image:url('assets/other2.jpg')"></div>
            <h3>Other 2</h3>
            <p class="muted">Landing page</p>
          </div>

        </div>
      </div>

      <button class="carousel-nav carousel-next" aria-label="Next">›</button>
    </div>

    <!-- GRID / CARD LIST VIEW -->
    <div id="gridView" class="grid-view hidden">
      <div class="project-grid">
        <div class="card glass project" data-key="klp" onclick="openCaseStudy('klp')">
          <h3>KLP Lifestyle</h3><p>E-commerce redesign</p>
        </div>
        <div class="card glass project" data-key="fixifoot" onclick="openCaseStudy('fixifoot')">
          <h3>Fixifoot</h3><p>Product showcase</p>
        </div>
        <div class="card glass project" data-key="cveez" onclick="openCaseStudy('cveez')">
          <h3>Cveez</h3><p>Service booking platform</p>
        </div>
        <div class="card glass project" data-key="other1" onclick="openCaseStudy('other1')">
          <h3>Other 1</h3><p>UI components</p>
        </div>
        <div class="card glass project" data-key="other2" onclick="openCaseStudy('other2')">
          <h3>Other 2</h3><p>Landing page</p>
        </div>
      </div>
    </div>

  </section>

  <!-- Case Study Modal -->
  <div id="case-study" class="modal" aria-hidden="true">
    <div class="modal-content glass" role="dialog" aria-modal="true">
      <span class="close" title="Close modal">&times;</span>
      <h3 id="case-title"></h3>
      <p id="case-problem"></p>
      <p id="case-process"></p>
      <p id="case-solution"></p>
      <a id="case-link" href="#" target="_blank" class="btn">View Live</a>
    </div>
  </div>

  <!-- Skills -->
  <section id="skills" class="page">
    <h2>Skills</h2>
    <div class="skills-list fade-in">
      <span class="chip">HTML5</span>
      <span class="chip">CSS3</span>
      <span class="chip">JavaScript</span>
      <span class="chip">React</span>
      <span class="chip">Figma</span>
      <span class="chip">UI/UX Design</span>
    </div>
  </section>

  <!-- Contact -->
  <section id="contact" class="page">
    <h2>Contact</h2>
    <div class="card glass fade-in">
      <p>Email: <a href="mailto:gendeulgagarin@gmail.com">gendeulgagarin@gmail.com</a></p>
      <p>LinkedIn: <a href="https://linkedin.com/in/gen-deu-gagarin-952781165" target="_blank">linkedin.com/in/gen-deu-gagarin</a></p>
      <p>GitHub: <a href="https://github.com/gendeu" target="_blank">github.com/gendeu</a></p>
    </div>
  </section>

  <footer>
    <p>© 2025 Gen Deu Gagarin | Designed with ❤️</p>
  </footer>

<script>
/* Dynamic carousel + centered-click modal + mode toggle
   Drop-in replacement for the script you provided.
   IMPORTANT: description innerHTML is set only from trusted sources (same as your original note). */
document.addEventListener('DOMContentLoaded', async () => {
  // ---- CONFIG ----
  const DATA_URL = '/path/to/your/carousel.json'; // keep or replace
  const INITIAL_INDEX = 2; // default starting index

  // FALLBACK: keep your FALLBACK data here or refer to existing variable (omitted for brevity)
  const FALLBACK = window.CAROUSEL_FALLBACK || [];

  // ---- ELEMENTS ----
  const container = document.querySelector('.carousel-track-container');
  const track = document.querySelector('.carousel-track');
  const prevBtn = document.querySelector('.arrow-btn.prev');
  const nextBtn = document.querySelector('.arrow-btn.next');
  const descriptionBox = document.querySelector('.carousel-description');
  const carouselRoot = document.querySelector('.custom-carousel'); // wrapper

  if (!container || !track || !prevBtn || !nextBtn) {
    console.warn('Carousel: missing DOM elements');
    return;
  }

  // Modal: create lightweight modal if not present
  let modal = document.getElementById('carousel-modal');
  if (!modal) {
    modal = document.createElement('div');
    modal.id = 'carousel-modal';
    modal.style.cssText = 'position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.6);z-index:9999;';
    modal.innerHTML = `
      <div role="dialog" aria-modal="true" style="max-width:820px;width:90%;background:#fff;border-radius:12px;padding:18px;position:relative;box-shadow:0 10px 40px rgba(0,0,0,.35);color:#111;">
        <button aria-label="Close" id="carousel-modal-close" style="position:absolute;right:14px;top:10px;border:none;background:transparent;font-size:20px;cursor:pointer">✕</button>
        <div id="carousel-modal-body" style="display:flex;gap:18px;align-items:flex-start;flex-wrap:wrap;">
          <img id="carousel-modal-img" src="" alt="" style="max-width:320px;width:100%;height:auto;border-radius:8px;object-fit:cover;">
          <div style="flex:1;min-width:220px">
            <h3 id="carousel-modal-title" style="margin:0 0 10px 0"></h3>
            <div id="carousel-modal-desc" style="color:#333;line-height:1.45"></div>
          </div>
        </div>
      </div>
    `;
    document.body.appendChild(modal);

    // close handlers
    const closeBtn = document.getElementById('carousel-modal-close');
    closeBtn.addEventListener('click', closeModal);
    modal.addEventListener('click', (ev) => { if (ev.target === modal) closeModal(); });
    window.addEventListener('keydown', (ev) => { if (ev.key === 'Escape') closeModal(); });
  }

  function openModal(data) {
    // data: {img, alt, title, description}
    if (!data) return;
    const img = document.getElementById('carousel-modal-img');
    const title = document.getElementById('carousel-modal-title');
    const desc = document.getElementById('carousel-modal-desc');

    img.src = data.img || '';
    img.alt = data.alt || '';
    title.textContent = data.title || '';
    // set trusted HTML (only when API is trusted)
    desc.innerHTML = data.description || '';

    modal.style.display = 'flex';
    // small entrance
    requestAnimationFrame(() => { modal.style.opacity = 1; });
  }

  function closeModal() {
    modal.style.opacity = 0;
    setTimeout(() => modal.style.display = 'none', 180);
  }

  // ---- Carousel internals ----
  let slides = [];
  let currentIndex = 0;

  function clamp(n, a, b) { return Math.max(a, Math.min(b, n)); }

  function buildSlides(data) {
    const frag = document.createDocumentFragment();
    data.forEach(item => {
      const slide = document.createElement('div');
      slide.className = 'carousel-slide';
      slide.dataset.description = item.description ? String(item.description) : '';
      slide.dataset.img = item.img || '';
      slide.dataset.alt = item.alt || '';
      slide.dataset.title = item.title || '';

      const img = document.createElement('img');
      img.src = item.img || '';
      img.alt = item.alt || '';

      const p = document.createElement('p');
      p.textContent = (item.title || '').trim();
      if (!p.textContent) {
        p.classList.add('hidden');
        slide.classList.add('no-title');
      }

      slide.appendChild(img);
      slide.appendChild(p);
      frag.appendChild(slide);
    });

    track.innerHTML = '';
    track.appendChild(frag);
    slides = Array.from(track.querySelectorAll('.carousel-slide'));

    // click handler will either center or open modal when centered
    slides.forEach((s, idx) => {
      s.addEventListener('click', () => {
        if (isSlideCentered(s)) {
          // open modal using slide dataset
          openModal({
            img: s.dataset.img,
            alt: s.dataset.alt,
            title: s.dataset.title,
            description: s.dataset.description
          });
        } else {
          currentIndex = idx;
          centerActive();
        }
      });

      // make each slide focusable for keyboard users
      s.tabIndex = 0;
      s.addEventListener('keydown', (ev) => {
        if (ev.key === 'Enter' || ev.key === ' ') {
          ev.preventDefault();
          s.click();
        }
      });
    });
  }

  // compute and set transform to center currentIndex slide
  function centerActive() {
    if (!slides.length) return;

    slides.forEach(s => s.classList.remove('active'));
    const active = slides[currentIndex];
    if (!active) return;
    active.classList.add('active');

    // compute desired translateX so active is centered inside container
    const containerWidth = container.clientWidth;
    const trackWidth = track.scrollWidth;
    const targetCenter = active.offsetLeft + (active.offsetWidth / 2);
    // desired translate so targetCenter becomes container center:
    let translate = (containerWidth / 2) - targetCenter;

    // clamp translate so we don't reveal blank edges
    const maxTranslate = 0; // can't move right past 0
    const minTranslate = Math.min(containerWidth - trackWidth, 0); // negative or 0
    translate = clamp(translate, minTranslate, maxTranslate);

    track.style.transform = `translateX(${translate}px)`;

    updateButtons();
    updateDescription();
  }

  function updateButtons() {
    prevBtn.disabled = currentIndex === 0;
    nextBtn.disabled = currentIndex === slides.length - 1;
  }

  function updateDescription() {
    if (!slides[currentIndex]) return;
    const desc = slides[currentIndex].dataset.description || '';
    if (desc.trim()) {
      descriptionBox.innerHTML = desc;
      descriptionBox.classList.remove('hidden');
    } else {
      descriptionBox.innerHTML = '';
      descriptionBox.classList.add('hidden');
    }
  }

  function isSlideCentered(slideEl) {
    if (!slideEl) return false;
    const containerRect = container.getBoundingClientRect();
    const slideRect = slideEl.getBoundingClientRect();
    const slideCenter = slideRect.left + (slideRect.width / 2);
    const containerCenter = containerRect.left + (containerRect.width / 2);
    // Consider centered if distance < 40% of slide width (tweakable)
    return Math.abs(slideCenter - containerCenter) < (slideRect.width * 0.4);
  }

  // ---- Data loader ----
  async function loadData() {
    if (Array.isArray(window.CAROUSEL_DATA)) return window.CAROUSEL_DATA;
    try {
      const res = await fetch(DATA_URL, { cache: 'no-store' });
      if (!res.ok) throw new Error('Bad response');
      const json = await res.json();
      if (!Array.isArray(json)) throw new Error('JSON must be an array');
      return json;
    } catch (err) {
      console.warn('Carousel: using fallback data. Reason:', err);
      return FALLBACK.slice(); // clone
    }
  }

  // ---- Init ----
  const data = await loadData();
  buildSlides(data || []);
  currentIndex = clamp(INITIAL_INDEX, 0, Math.max(0, slides.length - 1));

  prevBtn.addEventListener('click', () => {
    if (currentIndex > 0) {
      currentIndex--;
      centerActive();
    }
  });

  nextBtn.addEventListener('click', () => {
    if (currentIndex < slides.length - 1) {
      currentIndex++;
      centerActive();
    }
  });

  // keyboard prev/next for accessibility
  prevBtn.addEventListener('keydown', (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); prevBtn.click(); } });
  nextBtn.addEventListener('keydown', (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); nextBtn.click(); } });

  // keep centered on resize
  window.addEventListener('resize', () => {
    // small timeout to let layout settle
    setTimeout(centerActive, 60);
  });

  // initial centering
  setTimeout(centerActive, 40);

  // ---- Expose mode helper (game/list toggles) ----
  // Use setCarouselMode('game') or setCarouselMode('list') to toggle visibility.
  // This prevents the carousel showing when not in game mode.
  window.setCarouselMode = function (mode) {
    if (!carouselRoot) return;
    if (mode === 'game') {
      carouselRoot.style.display = ''; // show (fall back to CSS)
    } else {
      // hide carousel when not game mode; keep description hidden too
      carouselRoot.style.display = 'none';
      descriptionBox.classList.add('hidden');
    }
  };

  // optionally set initial mode (if you keep a data attribute or localStorage)
  // e.g. window.setCarouselMode(localStorage.getItem('carouselMode') || 'game');

  // ---- Optional: click-to-drag (basic) ----
  // This is a minimal draggable track to behave like a carousel scrollbar.
  let isDown = false, startX = 0, startTranslate = 0;
  track.addEventListener('pointerdown', (ev) => {
    isDown = true;
    track.setPointerCapture(ev.pointerId);
    startX = ev.clientX;
    // extract current translateX from transform
    const m = getComputedStyle(track).transform.match(/matrix\\(([^)]+)\\)/);
    startTranslate = 0;
    if (m) {
      const vals = m[1].split(',').map(v => parseFloat(v.trim()));
      // matrix(a, b, c, d, tx, ty) -> tx is translateX
      startTranslate = vals[4] || 0;
    }
    track.style.transition = 'none';
  }, { passive: true });

  track.addEventListener('pointermove', (ev) => {
    if (!isDown) return;
    const dx = ev.clientX - startX;
    let next = startTranslate + dx;
    // clamp to bounds
    const trackWidth = track.scrollWidth;
    const minTranslate = Math.min(container.clientWidth - trackWidth, 0);
    const maxTranslate = 0;
    next = clamp(next, minTranslate, maxTranslate);
    track.style.transform = `translateX(${next}px)`;
  }, { passive: true });

  const endDrag = (ev) => {
    if (!isDown) return;
    isDown = false;
    try { track.releasePointerCapture(ev && ev.pointerId); } catch (e) {}
    track.style.transition = ''; // restore
    // snap to closest slide
    // find centered slide and set currentIndex
    let bestIndex = 0, bestDist = Infinity;
    const containerRect = container.getBoundingClientRect();
    const containerCenterX = containerRect.left + (containerRect.width / 2);
    slides.forEach((s, i) => {
      const r = s.getBoundingClientRect();
      const sCenter = r.left + (r.width / 2);
      const d = Math.abs(sCenter - containerCenterX);
      if (d < bestDist) { bestDist = d; bestIndex = i; }
    });
    currentIndex = bestIndex;
    centerActive();
  };
  track.addEventListener('pointerup', endDrag);
  track.addEventListener('pointercancel', endDrag);
  track.addEventListener('pointerleave', endDrag);

});
</script>

</body>
</html>
